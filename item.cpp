/*==============================================================================

weedの処理 [weed.cpp]
作成者 : 中西　祐介
作成日 :
--------------------------------------------------------------------------------
■Update :
==============================================================================*/

/*------------------------------------------------------------------------------
　ヘッダファイル
------------------------------------------------------------------------------*/
#include "main.h"
#include "modeGame.h"
#include "textureManager.h"
#include "renderer.h"
#include "item.h"
#include "camera.h"
#include "light.h"

/*------------------------------------------------------------------------------
 　マクロ定義
------------------------------------------------------------------------------*/

/*------------------------------------------------------------------------------
  　デストラクタ
------------------------------------------------------------------------------*/
CItem::~CItem()
{
}

/*------------------------------------------------------------------------------
　初期化
------------------------------------------------------------------------------*/
void CItem::Init(D3DXVECTOR3 pos, D3DXVECTOR3 size, float velY)
{
	// パラメータ設定
	m_size = size;
	m_pos = pos;
	m_velocityY = velY;

	// ビルボードの初期化
	CBillboard::Init();

	// オブジェクトタイプの設定
	SetObjType(OBJTYPE_MESHFIELD);
}

/*------------------------------------------------------------------------------
　終了処理
------------------------------------------------------------------------------*/
void CItem::Uninit(void)
{
	CBillboard::Uninit();
	CScene::SetDelete();
}

/*------------------------------------------------------------------------------
　更新
------------------------------------------------------------------------------*/
void CItem::Update(void)
{
	// 移動
	m_velocityY -= 0.1f;
	m_pos.y += m_velocityY;

	// 高さ設定	
	float tempH = CModeGame::GetMeshField()->GetHeight(m_pos);
	if (m_pos.y < tempH) { m_pos.y = tempH; }
}

/*------------------------------------------------------------------------------
　ポリゴン描画処理
------------------------------------------------------------------------------*/
void CItem::Draw(void)
{
	CBillboard::Draw();
}

/*------------------------------------------------------------------------------
　作成
------------------------------------------------------------------------------*/
CItem* CItem::Create(D3DXVECTOR3 pos, D3DXVECTOR3 size, float velY, float alpha, char* filePass, CTextureManager::TEXTYPE textype)
{
	CItem* pItem = new CItem(2);
	pItem->SetTexID(CTextureManager::LoadTexture(filePass, textype));
	pItem->Init(pos, size, velY);
	return pItem;
}

